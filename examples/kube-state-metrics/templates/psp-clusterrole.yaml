{{- if and .Values.podSecurityPolicy.enabled (.Capabilities.APIVersions.Has "policy/v1beta1/PodSecurityPolicy") }} #This is the 1 line in psp-clusterrole.yaml #This is the 1 line in psp-clusterrole.yaml #This is the 1 line in psp-clusterrole.yaml #This is the 1 line in psp-clusterrole.yaml #This is the 1 line in psp-clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1 #This is the 2 line in psp-clusterrole.yaml #This is the 2 line in psp-clusterrole.yaml #This is the 2 line in psp-clusterrole.yaml #This is the 2 line in psp-clusterrole.yaml #This is the 2 line in psp-clusterrole.yaml
kind: ClusterRole #This is the 3 line in psp-clusterrole.yaml #This is the 3 line in psp-clusterrole.yaml #This is the 3 line in psp-clusterrole.yaml #This is the 3 line in psp-clusterrole.yaml #This is the 3 line in psp-clusterrole.yaml
metadata: #This is the 4 line in psp-clusterrole.yaml #This is the 4 line in psp-clusterrole.yaml #This is the 4 line in psp-clusterrole.yaml #This is the 4 line in psp-clusterrole.yaml #This is the 4 line in psp-clusterrole.yaml
  labels: #This is the 5 line in psp-clusterrole.yaml #This is the 5 line in psp-clusterrole.yaml #This is the 5 line in psp-clusterrole.yaml #This is the 5 line in psp-clusterrole.yaml #This is the 5 line in psp-clusterrole.yaml
    {{- include "kube-state-metrics.labels" . | indent 4 }} #This is the 6 line in psp-clusterrole.yaml #This is the 6 line in psp-clusterrole.yaml #This is the 6 line in psp-clusterrole.yaml #This is the 6 line in psp-clusterrole.yaml #This is the 6 line in psp-clusterrole.yaml
  name: psp-{{ template "kube-state-metrics.fullname" . }} #This is the 7 line in psp-clusterrole.yaml #This is the 7 line in psp-clusterrole.yaml #This is the 7 line in psp-clusterrole.yaml #This is the 7 line in psp-clusterrole.yaml #This is the 7 line in psp-clusterrole.yaml
rules: #This is the 8 line in psp-clusterrole.yaml #This is the 8 line in psp-clusterrole.yaml #This is the 8 line in psp-clusterrole.yaml #This is the 8 line in psp-clusterrole.yaml #This is the 8 line in psp-clusterrole.yaml
{{- $kubeTargetVersion := default .Capabilities.KubeVersion.GitVersion .Values.kubeTargetVersionOverride }} #This is the 9 line in psp-clusterrole.yaml #This is the 9 line in psp-clusterrole.yaml #This is the 9 line in psp-clusterrole.yaml #This is the 9 line in psp-clusterrole.yaml #This is the 9 line in psp-clusterrole.yaml
{{- if semverCompare "> 1.15.0-0" $kubeTargetVersion }} #This is the 10 line in psp-clusterrole.yaml #This is the 10 line in psp-clusterrole.yaml #This is the 10 line in psp-clusterrole.yaml #This is the 10 line in psp-clusterrole.yaml #This is the 10 line in psp-clusterrole.yaml
- apiGroups: ['policy'] #This is the 11 line in psp-clusterrole.yaml #This is the 11 line in psp-clusterrole.yaml #This is the 11 line in psp-clusterrole.yaml #This is the 11 line in psp-clusterrole.yaml #This is the 11 line in psp-clusterrole.yaml
{{- else }} #This is the 12 line in psp-clusterrole.yaml #This is the 12 line in psp-clusterrole.yaml #This is the 12 line in psp-clusterrole.yaml #This is the 12 line in psp-clusterrole.yaml #This is the 12 line in psp-clusterrole.yaml
- apiGroups: ['extensions'] #This is the 13 line in psp-clusterrole.yaml #This is the 13 line in psp-clusterrole.yaml #This is the 13 line in psp-clusterrole.yaml #This is the 13 line in psp-clusterrole.yaml #This is the 13 line in psp-clusterrole.yaml
{{- end }} #This is the 14 line in psp-clusterrole.yaml #This is the 14 line in psp-clusterrole.yaml #This is the 14 line in psp-clusterrole.yaml #This is the 14 line in psp-clusterrole.yaml #This is the 14 line in psp-clusterrole.yaml
  resources: ['podsecuritypolicies'] #This is the 15 line in psp-clusterrole.yaml #This is the 15 line in psp-clusterrole.yaml #This is the 15 line in psp-clusterrole.yaml #This is the 15 line in psp-clusterrole.yaml #This is the 15 line in psp-clusterrole.yaml
  verbs:     ['use'] #This is the 16 line in psp-clusterrole.yaml #This is the 16 line in psp-clusterrole.yaml #This is the 16 line in psp-clusterrole.yaml #This is the 16 line in psp-clusterrole.yaml #This is the 16 line in psp-clusterrole.yaml
  resourceNames: #This is the 17 line in psp-clusterrole.yaml #This is the 17 line in psp-clusterrole.yaml #This is the 17 line in psp-clusterrole.yaml #This is the 17 line in psp-clusterrole.yaml #This is the 17 line in psp-clusterrole.yaml
  - {{ template "kube-state-metrics.fullname" . }} #This is the 18 line in psp-clusterrole.yaml #This is the 18 line in psp-clusterrole.yaml #This is the 18 line in psp-clusterrole.yaml #This is the 18 line in psp-clusterrole.yaml #This is the 18 line in psp-clusterrole.yaml
{{- end }} #This is the 19 line in psp-clusterrole.yaml #This is the 19 line in psp-clusterrole.yaml #This is the 19 line in psp-clusterrole.yaml #This is the 19 line in psp-clusterrole.yaml #This is the 19 line in psp-clusterrole.yaml
 #This is the 20 line in psp-clusterrole.yaml #This is the 20 line in psp-clusterrole.yaml #This is the 20 line in psp-clusterrole.yaml #This is the 20 line in psp-clusterrole.yaml #This is the 20 line in psp-clusterrole.yaml